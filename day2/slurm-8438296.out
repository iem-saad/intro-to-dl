The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) ModuleLabel/label   2) lumi-tools/24.05   3) init-lumi/0.2

The following sticky modules could not be reloaded:

  1) lumi-tools
NOTE: This module uses Singularity. Some commands execute inside the container
(e.g. python3, pip3).

This module has been installed by CSC.

Documentation: https://docs.csc.fi/apps/pytorch/
Support: https://docs.csc.fi/support/contact/

python3 $*
+ python3 pytorch_gtsrb_cnn_simple.py
Using PyTorch version: 2.4.1+rocm6.1  Device: cuda
TensorBoard log directory: /pfs/lustrep1/users/sabdulla/PDL-2024-11/intro-to-dl/day2/logs/gtsrb-2024-11-13_11-21-26
Train: Found 5535 images belonging to 43 classes
Validation: Removing directory 00027
Removing directory 00039
Found 999 images belonging to 41 classes
Test: Found 12630 images belonging to 43 classes
Net(
  (layers): Sequential(
    (0): Conv2d(3, 32, kernel_size=(3, 3), stride=(1, 1))
    (1): ReLU()
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
    (3): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (4): ReLU()
    (5): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
    (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
    (7): ReLU()
    (8): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
    (9): Flatten(start_dim=1, end_dim=-1)
    (10): Linear(in_features=3136, out_features=128, bias=True)
    (11): ReLU()
    (12): Dropout(p=0.5, inplace=False)
    (13): Linear(in_features=128, out_features=43, bias=True)
  )
)
Epoch 1: train loss: 3.661224 train accuracy: 5.65%, val accuracy: 4.40%
Epoch 2: train loss: 3.529479 train accuracy: 5.35%, val accuracy: 5.01%
Epoch 3: train loss: 3.497057 train accuracy: 5.75%, val accuracy: 3.20%
Epoch 4: train loss: 3.440438 train accuracy: 7.66%, val accuracy: 10.51%
Epoch 5: train loss: 3.350917 train accuracy: 9.72%, val accuracy: 8.61%
Epoch 6: train loss: 3.166445 train accuracy: 15.90%, val accuracy: 21.72%
Epoch 7: train loss: 2.640588 train accuracy: 29.02%, val accuracy: 38.14%
Epoch 8: train loss: 2.158255 train accuracy: 37.96%, val accuracy: 42.74%
Epoch 9: train loss: 1.791429 train accuracy: 45.67%, val accuracy: 55.76%
Epoch 10: train loss: 1.483765 train accuracy: 54.40%, val accuracy: 57.96%
Epoch 11: train loss: 1.302379 train accuracy: 59.02%, val accuracy: 69.87%
Epoch 12: train loss: 1.076897 train accuracy: 65.62%, val accuracy: 77.28%
Epoch 13: train loss: 0.972976 train accuracy: 68.40%, val accuracy: 75.68%
Epoch 14: train loss: 0.859389 train accuracy: 72.79%, val accuracy: 76.38%
Epoch 15: train loss: 0.749109 train accuracy: 75.74%, val accuracy: 81.98%
Epoch 16: train loss: 0.695395 train accuracy: 77.65%, val accuracy: 84.38%
Epoch 17: train loss: 0.634279 train accuracy: 79.75%, val accuracy: 85.29%
Epoch 18: train loss: 0.589157 train accuracy: 80.87%, val accuracy: 87.79%
Epoch 19: train loss: 0.512909 train accuracy: 84.01%, val accuracy: 88.39%
Epoch 20: train loss: 0.538975 train accuracy: 82.64%, val accuracy: 89.09%
Epoch 21: train loss: 0.437609 train accuracy: 86.68%, val accuracy: 91.39%
Epoch 22: train loss: 0.407375 train accuracy: 86.14%, val accuracy: 92.29%
Epoch 23: train loss: 0.393626 train accuracy: 87.28%, val accuracy: 90.29%
Epoch 24: train loss: 0.397280 train accuracy: 87.61%, val accuracy: 92.39%
Epoch 25: train loss: 0.335675 train accuracy: 89.45%, val accuracy: 92.49%
Epoch 26: train loss: 0.308727 train accuracy: 90.46%, val accuracy: 92.49%
Epoch 27: train loss: 0.306576 train accuracy: 90.79%, val accuracy: 92.19%
Epoch 28: train loss: 0.279067 train accuracy: 90.97%, val accuracy: 94.19%
Epoch 29: train loss: 0.271592 train accuracy: 91.29%, val accuracy: 92.49%
Epoch 30: train loss: 0.250284 train accuracy: 92.05%, val accuracy: 93.29%
Epoch 31: train loss: 0.232732 train accuracy: 92.88%, val accuracy: 93.69%
Epoch 32: train loss: 0.222080 train accuracy: 93.59%, val accuracy: 94.89%
Epoch 33: train loss: 0.217538 train accuracy: 92.90%, val accuracy: 92.49%
Epoch 34: train loss: 0.199425 train accuracy: 93.79%, val accuracy: 93.69%
Epoch 35: train loss: 0.176819 train accuracy: 94.15%, val accuracy: 94.99%
Epoch 36: train loss: 0.181730 train accuracy: 94.27%, val accuracy: 92.69%
Epoch 37: train loss: 0.181596 train accuracy: 94.09%, val accuracy: 94.69%
Epoch 38: train loss: 0.166767 train accuracy: 94.51%, val accuracy: 95.20%
Epoch 39: train loss: 0.158390 train accuracy: 94.94%, val accuracy: 94.09%
Epoch 40: train loss: 0.167922 train accuracy: 94.74%, val accuracy: 95.20%
Epoch 41: train loss: 0.129612 train accuracy: 95.77%, val accuracy: 94.39%
Epoch 42: train loss: 0.133192 train accuracy: 95.97%, val accuracy: 94.99%
Epoch 43: train loss: 0.129638 train accuracy: 96.10%, val accuracy: 95.40%
Epoch 44: train loss: 0.134411 train accuracy: 95.28%, val accuracy: 94.79%
Epoch 45: train loss: 0.122087 train accuracy: 95.88%, val accuracy: 94.79%
Epoch 46: train loss: 0.113563 train accuracy: 96.35%, val accuracy: 94.89%
Epoch 47: train loss: 0.111429 train accuracy: 96.39%, val accuracy: 95.60%
Epoch 48: train loss: 0.109970 train accuracy: 96.75%, val accuracy: 94.89%
Epoch 49: train loss: 0.108785 train accuracy: 96.57%, val accuracy: 94.29%
Epoch 50: train loss: 0.091359 train accuracy: 97.09%, val accuracy: 95.60%
Total training time: 0:01:47.186318.

Testing: accuracy: 85.40%
